(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CompanyItem"],{"0036":function(e,t,n){"use strict";n("7514"),n("ac6a");var a=n("8daa");t["a"]={data:function(){return{fetched:!1,list:[]}},methods:{fetchItem:function(e,t,n){var i=this;this.fetched||Object(a["a"])({url:"".concat(e,"/").concat(this.$route.params.id),method:"GET"}).then(function(e){t.forEach(function(t){i[t]=e.data[t]}),i.fetched=!0,n&&i.afterFetch()})},setSelect:function(e,t,n,a){var i=this;this[e][n]=this[t].find(function(t){return t.id===i[e][a]})}}}},"0147":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container mw768"},[n("form",{attrs:{model:e.company,id:"company"}},[n("bulma-input",{attrs:{label:"",placeholder:"Наименование организации",iconLeft:"building"},model:{value:e.company.name,callback:function(t){e.$set(e.company,"name",t)},expression:"company.name"}}),n("bulma-select",{attrs:{list:e.scopes,"selected-item":e.company.scope,"item-name":"scope",label:"Сфера деятельности",iconLeft:"tag"},on:{select:e.onSelect}}),n("bulma-input",{attrs:{label:"",placeholder:"Адрес",iconLeft:"address-card"},model:{value:e.company.address,callback:function(t){e.$set(e.company,"address",t)},expression:"company.address"}}),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Электронный адрес")]),e._l(e.company.emails,function(t,a){return n("bulma-input",{key:a,attrs:{type:"email",placeholder:"Электронный адрес",iconLeft:"envelope",autocomplete:"email",pattern:'^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$',error:"Неправильный email"},on:{blur:function(t){e.onBlur("emails","email")}},model:{value:e.company.emails[a].email,callback:function(t){e.$set(e.company.emails[a],"email",t)},expression:"company.emails[index].email"}})})],2)]),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Телефон")]),e._l(e.company.phones,function(t,a){return n("bulma-input",{key:a,attrs:{type:"tel",placeholder:"Телефон",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(t){e.onBlur("phones","phone")}},model:{value:e.company.phones[a].phone,callback:function(t){e.$set(e.company.phones[a],"phone",t)},expression:"company.phones[index].phone"}})})],2)]),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Факс")]),e._l(e.company.faxes,function(t,a){return n("bulma-input",{key:a,attrs:{type:"tel",placeholder:"Факс",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(t){e.onBlur("faxes","phone")}},model:{value:e.company.faxes[a].phone,callback:function(t){e.$set(e.company.faxes[a],"phone",t)},expression:"company.faxes[index].phone"}})})],2)])]),e.company.practices?n("div",{key:"practices",staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Тренировки")]),e._l(e.company.practices,function(e){return n("bulma-input",{key:e.id,attrs:{value:e.date_str+" - "+e.kind_name+" - "+e.topic,hyper:"/practice/"+e.id,iconLeft:"history",readonly:""}})})],2):e._e(),e.company.contacts?n("div",{key:"contacts",staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Сотрудники")]),e._l(e.company.contacts,function(e){return n("bulma-input",{key:e.id,attrs:{value:e.name+" - "+e.post_name,hyper:"/contact/"+e.id,iconLeft:"user",readonly:""}})})],2):e._e(),n("bulma-input",{attrs:{label:"",placeholder:"Заметка",iconLeft:"sticky-note"},model:{value:e.company.note,callback:function(t){e.$set(e.company,"note",t)},expression:"company.note"}}),n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control"},[n("bulma-button",{attrs:{text:"Сохранить",color:"primary"},on:{click:e.submit}})],1),n("div",{staticClass:"control"},[n("bulma-button",{attrs:{text:"Закрыть"},on:{click:e.close}})],1),n("div",{staticClass:"control"},[n("bulma-button",{attrs:{text:"Удалить",color:"danger",onclick:"return confirm('Вы действительно хотите удалить эту запись?');"}})],1)])],1)])},i=[],c=(n("7f7f"),n("e04f")),o=n("e653"),s=n("ce02"),r=n("ccdc"),l=n("e78a"),u=n("a7a6"),p=n("7234"),d={id:0,name:"",address:"",scope:p["a"],scope_id:0,note:"",emails:[r["a"]],phones:[l["a"]],faxes:[u["a"]],practices:[{id:0,date_str:"",kind_name:"",topic:""}],contacts:[{id:0,name:"",department_name:"",post_name:"",post_go_name:""}]},m=n("2af4"),f=n("0036"),h=n("8daa"),y={name:"CompanyItem",components:{"bulma-input":c["a"],"bulma-button":o["a"],"bulma-select":s["a"]},mixins:[m["a"],f["a"]],data:function(){return{title:"",company:d,scopes:[p["a"]]}},mounted:function(){this.fetchData()},methods:{onBlur:function(e,t){if(this.checkArray(this.company[e],t)){var n={};n.id=this.company[e].length+1,n[t]="",this.company[e].push(n)}},onSelect:function(e){this.scope=e,this.company.scope_id=e.id},submit:function(){var e=this,t="companies",n="POST";"0"!==this.$route.params.id&&(t="".concat(t,"/").concat(this.$route.params.id),n="PUT");var a=this.company;a.emails=this.filterArray(a.emails,"email"),a.phones=this.filterArray(a.phones,"phone"),a.faxes=this.filterArray(a.faxes,"phone"),Object(h["a"])({url:t,method:n,mode:"cors",data:JSON.stringify(a)}).then(function(){e.close()})},close:function(){this.$router.push("/companies")},delete:function(){},fetchData:function(){this.fetchItem("companies",["company","scopes"],!0)},afterFetch:function(){this.company.emails?this.company.emails.push({id:this.company.emails.length+1,email:""}):this.company.emails=[{id:1,email:""}],this.company.phones?this.company.phones.push({id:this.company.phones.length+1,phone:""}):this.company.phones=[{id:1,phone:""}],this.company.faxes?this.company.faxes.push({id:this.company.faxes.length+1,phone:""}):this.company.faxes=[{id:1,phone:""}]},customLabel:function(e){return e.name}}},v=y,b=n("2877"),x=Object(b["a"])(v,a,i,!1,null,null,null);x.options.__file="CompanyItem.vue";t["default"]=x.exports},"0a49":function(e,t,n){var a=n("9b43"),i=n("626a"),c=n("4bf8"),o=n("9def"),s=n("cd1c");e.exports=function(e,t){var n=1==e,r=2==e,l=3==e,u=4==e,p=6==e,d=5==e||p,m=t||s;return function(t,s,f){for(var h,y,v=c(t),b=i(v),x=a(s,f,3),g=o(b.length),$=0,_=n?m(t,g):r?m(t,0):void 0;g>$;$++)if((d||$ in b)&&(h=b[$],y=x(h,$,v),e))if(n)_[$]=y;else if(y)switch(e){case 3:return!0;case 5:return h;case 6:return $;case 2:_.push(h)}else if(u)return!1;return p?-1:l||u?u:_}}},1169:function(e,t,n){var a=n("2d95");e.exports=Array.isArray||function(e){return"Array"==a(e)}},"2af4":function(e,t,n){"use strict";n("a481"),n("ac6a");t["a"]={methods:{checkArray:function(e,t){var n=-1,a=0,i=0;return e.forEach(function(e,c){""===e[t]?(-1===n&&(n=c),a+=1):i+=1}),a>1&&e.splice(n,1),i===e.length},filterArray:function(e,t){return e.filter(function(e){return e[t]&&""!==e[t]})},telephone:function(e){var t=e;return void 0!==t&&t.length>0&&(t=t.replace(/[^0-9]/g,""),10===t.length&&(t=t.replace(/(\d{3})(\d{3})(\d{2})(\d{2})/,"+7 ($1) $2-$3-$4")),11===t.length&&("8"===t[0]&&(t="7".concat(t.slice(1))),t=t.replace(/(\d)(\d{3})(\d{3})(\d{2})(\d{2})/,"+$1 ($2) $3-$4-$5")),7===t.length&&(t=t.replace(/(\d{3})(\d{2})(\d{2})/,"$1-$2-$3"))),t}}}},7514:function(e,t,n){"use strict";var a=n("5ca1"),i=n("0a49")(5),c="find",o=!0;c in[]&&Array(1)[c](function(){o=!1}),a(a.P+a.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(c)},a481:function(e,t,n){"use strict";var a=n("cb7c"),i=n("4bf8"),c=n("9def"),o=n("4588"),s=n("0390"),r=n("5f1b"),l=Math.max,u=Math.min,p=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,m=/\$([$&`']|\d\d?)/g,f=function(e){return void 0===e?e:String(e)};n("214f")("replace",2,function(e,t,n,h){return[function(a,i){var c=e(this),o=void 0==a?void 0:a[t];return void 0!==o?o.call(a,c,i):n.call(String(c),a,i)},function(e,t){var i=h(n,e,this,t);if(i.done)return i.value;var p=a(e),d=String(this),m="function"===typeof t;m||(t=String(t));var v=p.global;if(v){var b=p.unicode;p.lastIndex=0}var x=[];while(1){var g=r(p,d);if(null===g)break;if(x.push(g),!v)break;var $=String(g[0]);""===$&&(p.lastIndex=s(d,c(p.lastIndex),b))}for(var _="",k=0,C=0;C<x.length;C++){g=x[C];for(var A=String(g[0]),S=l(u(o(g.index),d.length),0),w=[],L=1;L<g.length;L++)w.push(f(g[L]));var I=g.groups;if(m){var O=[A].concat(w,S,d);void 0!==I&&O.push(I);var B=String(t.apply(void 0,O))}else B=y(A,d,S,w,I,t);S>=k&&(_+=d.slice(k,S)+B,k=S+A.length)}return _+d.slice(k)}];function y(e,t,a,c,o,s){var r=a+e.length,l=c.length,u=m;return void 0!==o&&(o=i(o),u=d),n.call(s,u,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(r);case"<":s=o[i.slice(1,-1)];break;default:var u=+i;if(0===u)return i;if(u>l){var d=p(u/10);return 0===d?i:d<=l?void 0===c[d-1]?i.charAt(1):c[d-1]+i.charAt(1):i}s=c[u-1]}return void 0===s?"":s})}})},a7a6:function(e,t,n){"use strict";t["a"]={id:0,phone:"",fax:!0}},ccdc:function(e,t,n){"use strict";t["a"]={id:0,email:""}},cd1c:function(e,t,n){var a=n("e853");e.exports=function(e,t){return new(a(e))(t)}},e78a:function(e,t,n){"use strict";t["a"]={id:0,phone:"",fax:!1}},e853:function(e,t,n){var a=n("d3f4"),i=n("1169"),c=n("2b4c")("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),a(t)&&(t=t[c],null===t&&(t=void 0))),void 0===t?Array:t}}}]);
//# sourceMappingURL=CompanyItem.0bea7e41.js.map