(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ContactItem"],{"2af4":function(t,a,e){"use strict";e("a481"),e("ac6a");a["a"]={methods:{checkArray:function(t,a){var e=-1,n=0,c=0;return t.forEach(function(t,o){""===t[a]?(-1===e&&(e=o),n+=1):c+=1}),n>1&&t.splice(e,1),c===t.length},filterArray:function(t,a){return t.filter(function(t){return t[a]&&""!==t[a]})},telephone:function(t){var a=t;return void 0!==a&&a.length>0&&(a=a.replace(/[^0-9]/g,""),10===a.length&&(a=a.replace(/(\d{3})(\d{3})(\d{2})(\d{2})/,"+7 ($1) $2-$3-$4")),11===a.length&&("8"===a[0]&&(a="7".concat(a.slice(1))),a=a.replace(/(\d)(\d{3})(\d{3})(\d{2})(\d{2})/,"+$1 ($2) $3-$4-$5")),7===a.length&&(a=a.replace(/(\d{3})(\d{2})(\d{2})/,"$1-$2-$3"))),a}}}},6188:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container mw768"},[e("form",{attrs:{model:t.contact,id:"contact"}},[e("bulma-input",{attrs:{label:"",placeholder:"Полное имя",iconLeft:"user"},model:{value:t.contact.name,callback:function(a){t.$set(t.contact,"name",a)},expression:"contact.name"}}),e("bulma-select",{attrs:{list:t.companies,"selected-item":t.contact.company,label:"Организация","item-name":"company",iconLeft:"building"},on:{select:t.onSelect}}),e("div",{staticClass:"columns"},[e("div",{staticClass:"column is-half"},[e("bulma-select",{attrs:{list:t.posts,"selected-item":t.contact.post,label:"Должность","item-name":"post",iconLeft:"tag"},on:{select:t.onSelect}})],1),e("div",{staticClass:"column is-half"},[e("bulma-select",{attrs:{list:t.departments,"selected-item":t.contact.department,label:"Отдел","item-name":"department",iconLeft:"tag"},on:{select:t.onSelect}})],1)]),e("div",{staticClass:"columns"},[e("div",{staticClass:"column is-half"},[e("bulma-select",{attrs:{list:t.posts_go,"selected-item":t.contact.post_go,label:"Должность ГО","item-name":"post_go",iconLeft:"tag"},on:{select:t.onSelect}})],1),e("div",{staticClass:"column is-half"},[e("bulma-select",{attrs:{list:t.ranks,"selected-item":t.contact.rank,label:"Звание","item-name":"rank",iconLeft:"tag"},on:{select:t.onSelect}})],1)]),e("div",{staticClass:"columns"},[e("div",{staticClass:"column is-one-third"},[e("bulma-date",{attrs:{label:"Дата рождения"},model:{value:t.contact.birthday,callback:function(a){t.$set(t.contact,"birthday",a)},expression:"contact.birthday"}})],1)]),e("div",{staticClass:"columns"},[e("div",{staticClass:"column"},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Электронный адрес")]),t._l(t.contact.emails,function(a,n){return e("bulma-input",{key:n,attrs:{type:"email",placeholder:"Электронный адрес",iconLeft:"envelope",autocomplete:"email",pattern:"pattern",error:"Неправильный email"},on:{blur:function(a){return t.onBlur("emails","email")}},model:{value:t.contact.emails[n].email,callback:function(a){t.$set(t.contact.emails[n],"email",a)},expression:"contact.emails[index].email"}})})],2)]),e("div",{staticClass:"column"},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Телефон")]),t._l(t.contact.phones,function(a,n){return e("bulma-input",{key:n,attrs:{type:"tel",placeholder:"Телефон",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(a){return t.onBlur("phones","phone")}},model:{value:t.contact.phones[n].phone,callback:function(a){t.$set(t.contact.phones[n],"phone",a)},expression:"contact.phones[index].phone"}})})],2)]),e("div",{staticClass:"column"},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Факс")]),t._l(t.contact.faxes,function(a,n){return e("bulma-input",{key:n,attrs:{type:"tel",placeholder:"Факс",iconLeft:"fax",autocomplete:"tel"},on:{blur:function(a){return t.onBlur("faxes","phone")}},model:{value:t.contact.faxes[n].phone,callback:function(a){t.$set(t.contact.faxes[n],"phone",a)},expression:"contact.faxes[index].phone"}})})],2)])]),t.contact.practices?e("div",{key:"practices",staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Тренировки")]),t._l(t.contact.practices,function(t){return e("bulma-input",{key:t.id,attrs:{hyper:"/practice/"+t.id,readonly:"",value:t.date_str+" - "+t.kind.name+" - "+t.topic,iconLeft:"graduation-cap"}})})],2):t._e(),e("bulma-input",{attrs:{label:"Заметка",placeholder:"Заметка",iconLeft:"comment"},model:{value:t.contact.note,callback:function(a){t.$set(t.contact,"note",a)},expression:"contact.note"}}),e("div",{staticClass:"field is-grouped is-grouped-centered"},[e("div",{staticClass:"control"},[e("bulma-button",{attrs:{text:"Сохранить",color:"primary"},on:{click:t.submit}})],1),e("div",{staticClass:"control"},[e("bulma-button",{attrs:{text:"Закрыть"},on:{click:t.close}})],1),e("div",{staticClass:"control"},[e("bulma-button",{attrs:{text:"Удалить",color:"danger",onclick:"return confirm('Вы действительно хотите удалить эту запись?');"}})],1)])],1)])},c=[],o=e("e04f"),s=e("e653"),i=e("ce02"),l=e("2bd6"),r=e("ccdc"),u=e("e78a"),d=e("a7a6"),p=e("7234"),m={id:0,name:"",birthday:"",company:p["a"],company_id:0,post:p["a"],post_id:0,department:p["a"],department_id:0,post_go:p["a"],post_go_id:0,rank:p["a"],rank_id:0,emails:[r["a"]],phones:[u["a"]],faxes:[d["a"]],note:""},f=e("2af4"),h=e("8daa"),b={name:"ContactItem",components:{"bulma-input":o["a"],"bulma-button":s["a"],"bulma-select":i["a"],"bulma-date":l["a"]},mixins:[f["a"]],data:function(){return{title:"",contact:m,companies:[p["a"]],posts:[p["a"]],posts_go:[p["a"]],departments:[p["a"]],ranks:[p["a"]],pattern:'^(([^<>()[]\\.,;:s@"]+(.[^<>()[]\\.,;:s@"]+)*)|(".+"))@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}])|(([a-zA-Z-0-9]+.)+[a-zA-Z]{2,}))$'}},mounted:function(){this.fetchData()},methods:{onBlur:function(t,a){if(this.checkArray(this.contact[t],a)){var e={};e.id=this.contact[t].length+1,e[a]="",this.contact[t].push(e)}},onSelect:function(t,a){this.contact[a]=t,this.contact["".concat(a,"_id")]=t.id},submit:function(){var t=this,a="/contacts",e="POST";"0"!==this.$route.params.id&&(a="".concat(a,"/").concat(this.$route.params.id),e="PUT");var n=this.contact;n.emails=this.filterArray(n.emails,"email"),n.phones=this.filterArray(n.phones,"phone"),n.faxes=this.filterArray(n.faxes,"phone"),Object(h["a"])({url:a,method:e,mode:"cors",data:JSON.stringify(n)}).then(function(){t.close()})},close:function(){this.$router.go(-2)},delete:function(){},fetchData:function(){var t=this;Object(h["a"])({url:"contacts/".concat(this.$route.params.id),method:"GET"}).then(function(a){t.contact=a.data.contact,t.companies=a.data.companies,t.posts=a.data.posts,t.departments=a.data.departments,t.posts_go=a.data.posts_go,t.ranks=a.data.ranks,t.contact.emails?t.contact.emails.push({id:t.contact.emails.length+1,email:""}):t.contact.emails=[{id:1,email:""}],t.contact.phones?t.contact.phones.push({id:t.contact.phones.length+1,phone:""}):t.contact.phones=[{id:1,phone:""}],t.contact.faxes?t.contact.faxes.push({id:t.contact.faxes.length+1,phone:""}):t.contact.faxes=[{id:1,phone:""}],t.isLoaded=!0})}}},v=b,g=(e("eb3c"),e("2877")),x=Object(g["a"])(v,n,c,!1,null,"f9b5f722",null);a["default"]=x.exports},"919e":function(t,a,e){},a481:function(t,a,e){"use strict";var n=e("cb7c"),c=e("4bf8"),o=e("9def"),s=e("4588"),i=e("0390"),l=e("5f1b"),r=Math.max,u=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,m=/\$([$&`']|\d\d?)/g,f=function(t){return void 0===t?t:String(t)};e("214f")("replace",2,function(t,a,e,h){return[function(n,c){var o=t(this),s=void 0==n?void 0:n[a];return void 0!==s?s.call(n,o,c):e.call(String(o),n,c)},function(t,a){var c=h(e,t,this,a);if(c.done)return c.value;var d=n(t),p=String(this),m="function"===typeof a;m||(a=String(a));var v=d.global;if(v){var g=d.unicode;d.lastIndex=0}var x=[];while(1){var k=l(d,p);if(null===k)break;if(x.push(k),!v)break;var $=String(k[0]);""===$&&(d.lastIndex=i(p,o(d.lastIndex),g))}for(var y="",C=0,_=0;_<x.length;_++){k=x[_];for(var S=String(k[0]),L=r(u(s(k.index),p.length),0),A=[],w=1;w<k.length;w++)A.push(f(k[w]));var I=k.groups;if(m){var O=[S].concat(A,L,p);void 0!==I&&O.push(I);var B=String(a.apply(void 0,O))}else B=b(S,p,L,A,I,a);L>=C&&(y+=p.slice(C,L)+B,C=L+S.length)}return y+p.slice(C)}];function b(t,a,n,o,s,i){var l=n+t.length,r=o.length,u=m;return void 0!==s&&(s=c(s),u=p),e.call(i,u,function(e,c){var i;switch(c.charAt(0)){case"$":return"$";case"&":return t;case"`":return a.slice(0,n);case"'":return a.slice(l);case"<":i=s[c.slice(1,-1)];break;default:var u=+c;if(0===u)return e;if(u>r){var p=d(u/10);return 0===p?e:p<=r?void 0===o[p-1]?c.charAt(1):o[p-1]+c.charAt(1):e}i=o[u-1]}return void 0===i?"":i})}})},a7a6:function(t,a,e){"use strict";a["a"]={id:0,phone:"",fax:!0}},ccdc:function(t,a,e){"use strict";a["a"]={id:0,email:""}},e78a:function(t,a,e){"use strict";a["a"]={id:0,phone:"",fax:!1}},eb3c:function(t,a,e){"use strict";var n=e("919e"),c=e.n(n);c.a}}]);
//# sourceMappingURL=ContactItem.57141ce5.js.map