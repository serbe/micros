(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CompanyItem"],{"0036":function(e,t,n){"use strict";n("7514"),n("ac6a");var a=n("8daa");t["a"]={data:function(){return{fetched:!1,list:[]}},methods:{fetchItem:function(e,t,n){var c=this;this.fetched||Object(a["a"])({url:"".concat(e,"/").concat(this.$route.params.id),method:"GET"}).then(function(e){t.forEach(function(t){c[t]=e.data[t]}),c.fetched=!0,n&&c.afterFetch()})},setSelect:function(e,t,n,a){var c=this;this[e][n]=this[t].find(function(t){return t.id===c[e][a]})}}}},"0147":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container mw768"},[n("form",{attrs:{model:e.company,id:"company"}},[n("bulma-input",{attrs:{label:"",placeholder:"Наименование организации",iconLeft:"building"},model:{value:e.company.name,callback:function(t){e.$set(e.company,"name",t)},expression:"company.name"}}),n("bulma-select",{attrs:{list:e.scopes,"selected-item":e.company.scope,"item-name":"scope",label:"Сфера деятельности",iconLeft:"tag"},on:{select:e.onSelect}}),n("bulma-input",{attrs:{label:"",placeholder:"Адрес",iconLeft:"address-card"},model:{value:e.company.address,callback:function(t){e.$set(e.company,"address",t)},expression:"company.address"}}),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Электронный адрес")]),e._l(e.company.emails,function(t,a){return n("bulma-input",{key:a,attrs:{type:"email",placeholder:"Электронный адрес",iconLeft:"envelope",autocomplete:"email",pattern:"pattern",error:"Неправильный email"},on:{blur:function(t){e.onBlur("emails","email")}},model:{value:e.company.emails[a].email,callback:function(t){e.$set(e.company.emails[a],"email",t)},expression:"company.emails[index].email"}})})],2)]),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Телефон")]),e._l(e.company.phones,function(t,a){return n("bulma-input",{key:a,attrs:{type:"tel",placeholder:"Телефон",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(t){e.onBlur("phones","phone")}},model:{value:e.company.phones[a].phone,callback:function(t){e.$set(e.company.phones[a],"phone",t)},expression:"company.phones[index].phone"}})})],2)]),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Факс")]),e._l(e.company.faxes,function(t,a){return n("bulma-input",{key:a,attrs:{type:"tel",placeholder:"Факс",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(t){e.onBlur("faxes","phone")}},model:{value:e.company.faxes[a].phone,callback:function(t){e.$set(e.company.faxes[a],"phone",t)},expression:"company.faxes[index].phone"}})})],2)])]),e.company.practices?n("div",{key:"practices",staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Тренировки")]),e._l(e.company.practices,function(e){return n("bulma-input",{key:e.id,attrs:{value:e.date_str+" - "+e.kind_name+" - "+e.topic,hyper:"/practice/"+e.id,iconLeft:"history",readonly:""}})})],2):e._e(),e.company.contacts?n("div",{key:"contacts",staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Сотрудники")]),e._l(e.company.contacts,function(e){return n("bulma-input",{key:e.id,attrs:{value:e.name+" - "+e.post_name,hyper:"/contact/"+e.id,iconLeft:"user",readonly:""}})})],2):e._e(),n("bulma-input",{attrs:{label:"",placeholder:"Заметка",iconLeft:"sticky-note"},model:{value:e.company.note,callback:function(t){e.$set(e.company,"note",t)},expression:"company.note"}}),n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control"},[n("bulma-button",{attrs:{text:"Сохранить",color:"primary"},on:{click:e.submit}})],1),n("div",{staticClass:"control"},[n("bulma-button",{attrs:{text:"Закрыть"},on:{click:e.close}})],1),n("div",{staticClass:"control"},[n("bulma-button",{attrs:{text:"Удалить",color:"danger",onclick:"return confirm('Вы действительно хотите удалить эту запись?');"}})],1)])],1)])},c=[],i=(n("7f7f"),n("f499")),o=n.n(i),s=(n("cadf"),n("551c"),n("097d"),n("e04f")),r=n("e653"),l=n("ce02"),u=n("ccdc"),p=n("e78a"),d=n("a7a6"),f=n("7234"),m={id:0,name:"",address:"",scope:f["a"],scope_id:0,note:"",emails:[u["a"]],phones:[p["a"]],faxes:[d["a"]],practices:[{id:0,date_str:"",kind_name:"",topic:""}],contacts:[{id:0,name:"",department_name:"",post_name:"",post_go_name:""}]},h=n("2af4"),y=n("0036"),v=n("8daa"),b={name:"CompanyItem",components:{"bulma-input":s["a"],"bulma-button":r["a"],"bulma-select":l["a"]},mixins:[h["a"],y["a"]],data:function(){return{title:"",company:m,scopes:[f["a"]],pattern:'^(([^<>()[]\\.,;:s@"]+(.[^<>()[]\\.,;:s@"]+)*)|(".+"))@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}])|(([a-zA-Z-0-9]+.)+[a-zA-Z]{2,}))$'}},mounted:function(){this.fetchData()},methods:{onBlur:function(e,t){if(this.checkArray(this.company[e],t)){var n={};n.id=this.company[e].length+1,n[t]="",this.company[e].push(n)}},onSelect:function(e){this.scope=e,this.company.scope_id=e.id},submit:function(){var e=this,t="companies",n="POST";"0"!==this.$route.params.id&&(t="".concat(t,"/").concat(this.$route.params.id),n="PUT");var a=this.company;a.emails=this.filterArray(a.emails,"email"),a.phones=this.filterArray(a.phones,"phone"),a.faxes=this.filterArray(a.faxes,"phone"),Object(v["a"])({url:t,method:n,mode:"cors",data:o()(a)}).then(function(){e.close()})},close:function(){this.$router.push("/companies")},delete:function(){},fetchData:function(){this.fetchItem("companies",["company","scopes"],!0)},afterFetch:function(){this.company.emails?this.company.emails.push({id:this.company.emails.length+1,email:""}):this.company.emails=[{id:1,email:""}],this.company.phones?this.company.phones.push({id:this.company.phones.length+1,phone:""}):this.company.phones=[{id:1,phone:""}],this.company.faxes?this.company.faxes.push({id:this.company.faxes.length+1,phone:""}):this.company.faxes=[{id:1,phone:""}]},customLabel:function(e){return e.name}}},x=b,g=n("2877"),$=Object(g["a"])(x,a,c,!1,null,null,null);t["default"]=$.exports},"0a49":function(e,t,n){var a=n("9b43"),c=n("626a"),i=n("4bf8"),o=n("9def"),s=n("cd1c");e.exports=function(e,t){var n=1==e,r=2==e,l=3==e,u=4==e,p=6==e,d=5==e||p,f=t||s;return function(t,s,m){for(var h,y,v=i(t),b=c(v),x=a(s,m,3),g=o(b.length),$=0,k=n?f(t,g):r?f(t,0):void 0;g>$;$++)if((d||$ in b)&&(h=b[$],y=x(h,$,v),e))if(n)k[$]=y;else if(y)switch(e){case 3:return!0;case 5:return h;case 6:return $;case 2:k.push(h)}else if(u)return!1;return p?-1:l||u?u:k}}},1169:function(e,t,n){var a=n("2d95");e.exports=Array.isArray||function(e){return"Array"==a(e)}},"2af4":function(e,t,n){"use strict";n("a481"),n("ac6a");t["a"]={methods:{checkArray:function(e,t){var n=-1,a=0,c=0;return e.forEach(function(e,i){""===e[t]?(-1===n&&(n=i),a+=1):c+=1}),a>1&&e.splice(n,1),c===e.length},filterArray:function(e,t){return e.filter(function(e){return e[t]&&""!==e[t]})},telephone:function(e){var t=e;return void 0!==t&&t.length>0&&(t=t.replace(/[^0-9]/g,""),10===t.length&&(t=t.replace(/(\d{3})(\d{3})(\d{2})(\d{2})/,"+7 ($1) $2-$3-$4")),11===t.length&&("8"===t[0]&&(t="7".concat(t.slice(1))),t=t.replace(/(\d)(\d{3})(\d{3})(\d{2})(\d{2})/,"+$1 ($2) $3-$4-$5")),7===t.length&&(t=t.replace(/(\d{3})(\d{2})(\d{2})/,"$1-$2-$3"))),t}}}},7514:function(e,t,n){"use strict";var a=n("5ca1"),c=n("0a49")(5),i="find",o=!0;i in[]&&Array(1)[i](function(){o=!1}),a(a.P+a.F*o,"Array",{find:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(i)},a481:function(e,t,n){"use strict";var a=n("cb7c"),c=n("4bf8"),i=n("9def"),o=n("4588"),s=n("0390"),r=n("5f1b"),l=Math.max,u=Math.min,p=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};n("214f")("replace",2,function(e,t,n,h){return[function(a,c){var i=e(this),o=void 0==a?void 0:a[t];return void 0!==o?o.call(a,i,c):n.call(String(i),a,c)},function(e,t){var c=h(n,e,this,t);if(c.done)return c.value;var p=a(e),d=String(this),f="function"===typeof t;f||(t=String(t));var v=p.global;if(v){var b=p.unicode;p.lastIndex=0}var x=[];while(1){var g=r(p,d);if(null===g)break;if(x.push(g),!v)break;var $=String(g[0]);""===$&&(p.lastIndex=s(d,i(p.lastIndex),b))}for(var k="",_=0,C=0;C<x.length;C++){g=x[C];for(var A=String(g[0]),w=l(u(o(g.index),d.length),0),S=[],L=1;L<g.length;L++)S.push(m(g[L]));var I=g.groups;if(f){var B=[A].concat(S,w,d);void 0!==I&&B.push(I);var E=String(t.apply(void 0,B))}else E=y(A,d,w,S,I,t);w>=_&&(k+=d.slice(_,w)+E,_=w+A.length)}return k+d.slice(_)}];function y(e,t,a,i,o,s){var r=a+e.length,l=i.length,u=f;return void 0!==o&&(o=c(o),u=d),n.call(s,u,function(n,c){var s;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(r);case"<":s=o[c.slice(1,-1)];break;default:var u=+c;if(0===u)return n;if(u>l){var d=p(u/10);return 0===d?n:d<=l?void 0===i[d-1]?c.charAt(1):i[d-1]+c.charAt(1):n}s=i[u-1]}return void 0===s?"":s})}})},a7a6:function(e,t,n){"use strict";t["a"]={id:0,phone:"",fax:!0}},ccdc:function(e,t,n){"use strict";t["a"]={id:0,email:""}},cd1c:function(e,t,n){var a=n("e853");e.exports=function(e,t){return new(a(e))(t)}},e78a:function(e,t,n){"use strict";t["a"]={id:0,phone:"",fax:!1}},e853:function(e,t,n){var a=n("d3f4"),c=n("1169"),i=n("2b4c")("species");e.exports=function(e){var t;return c(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!c(t.prototype)||(t=void 0),a(t)&&(t=t[i],null===t&&(t=void 0))),void 0===t?Array:t}}}]);
//# sourceMappingURL=CompanyItem.858d5c05.js.map