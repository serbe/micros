webpackJsonp([24],{"7RoA":function(e,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=n("mvHQ"),o=n.n(t),s=n("GE6z"),c=n("MeX/"),i=n("jKBc"),l=n("7lJq"),p=n("OOvn"),m={name:"company",components:{"vue-input":s.a,"vue-button":c.a,"vue-select":i.a},mixins:[l.a],data:function(){return{title:"",company:{id:0,name:"",address:"",scope:{id:0,name:""},scope_id:0,note:"",emails:[{id:0,email:""}],phones:[{id:0,phone:"",fax:!1}],faxes:[{id:0,phone:"",fax:!0}],practices:[{id:0,date_str:"",kind_name:"",topic:""}],contacts:[{id:0,name:"",department_name:"",post_name:"",post_go_name:""}]},scopes:[{id:0,name:""}]}},mounted:function(){this.fetchData()},methods:{onBlur:function(e,a){if(this.checkArray(this.company[e],a)){var n={};n.id=this.company[e].length+1,n[a]="",this.company[e].push(n)}},onSelect:function(e){this.scope=e,this.company.scope_id=e.id},submit:function(){var e=this,a="companies",n="POST";"0"!==this.$route.params.id&&(a=a+"/"+this.$route.params.id,n="PUT");var t=this.company;t.emails=this.filterArray(t.emails,"email"),t.phones=this.filterArray(t.phones,"phone"),t.faxes=this.filterArray(t.faxes,"phone"),Object(p.a)({url:a,method:n,mode:"cors",data:o()(t)}).then(function(){e.close()})},close:function(){this.$router.push("/companies")},delete:function(){},fetchData:function(){var e=this;Object(p.a)({url:"companies/"+this.$route.params.id,method:"GET"}).then(function(a){e.company=a.data.company,e.scopes=a.data.scopes,e.company.emails?e.company.emails.push({id:e.company.emails.length+1,email:""}):e.company.emails=[{id:1,email:""}],e.company.phones?e.company.phones.push({id:e.company.phones.length+1,phone:""}):e.company.phones=[{id:1,phone:""}],e.company.faxes?e.company.faxes.push({id:e.company.faxes.length+1,phone:""}):e.company.faxes=[{id:1,phone:""}],e.isLoaded=!0})},customLabel:function(e){return e.name}}},r={render:function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"container mw768"},[n("form",{attrs:{model:e.company,id:"company"}},[n("vue-input",{attrs:{label:"",placeholder:"Наименование организации",icon:"building"},model:{value:e.company.name,callback:function(a){e.$set(e.company,"name",a)},expression:"company.name"}}),e._v(" "),n("vue-select",{attrs:{list:e.scopes,"selected-item":e.company.scope,"item-name":"scope",label:"Сфера деятельности",icon:"tag"},on:{select:e.onSelect}}),e._v(" "),n("vue-input",{attrs:{label:"",placeholder:"Адрес",icon:"address-card"},model:{value:e.company.address,callback:function(a){e.$set(e.company,"address",a)},expression:"company.address"}}),e._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Электронный адрес")]),e._v(" "),e._l(e.company.emails,function(a,t){return n("vue-input",{key:t,attrs:{type:"email",placeholder:"Электронный адрес",icon:"envelope",autocomplete:"email",pattern:'^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$',error:"Неправильный email"},on:{blur:function(a){e.onBlur("emails","email")}},model:{value:e.company.emails[t].email,callback:function(a){e.$set(e.company.emails[t],"email",a)},expression:"company.emails[index].email"}})})],2)]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Телефон")]),e._v(" "),e._l(e.company.phones,function(a,t){return n("vue-input",{key:t,attrs:{type:"tel",placeholder:"Телефон",icon:"phone",autocomplete:"tel"},on:{blur:function(a){e.onBlur("phones","phone")}},model:{value:e.company.phones[t].phone,callback:function(a){e.$set(e.company.phones[t],"phone",a)},expression:"company.phones[index].phone"}})})],2)]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Факс")]),e._v(" "),e._l(e.company.faxes,function(a,t){return n("vue-input",{key:t,attrs:{type:"tel",placeholder:"Факс",icon:"phone",autocomplete:"tel"},on:{blur:function(a){e.onBlur("faxes","phone")}},model:{value:e.company.faxes[t].phone,callback:function(a){e.$set(e.company.faxes[t],"phone",a)},expression:"company.faxes[index].phone"}})})],2)])]),e._v(" "),e.company.practices?n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Тренировки")]),e._v(" "),e._l(e.company.practices,function(e){return n("vue-input",{key:e.id,attrs:{value:e.date_str+" - "+e.kind_name+" - "+e.topic,hyper:"/practice/"+e.id,icon:"history",disabled:""}})})],2):e._e(),e._v(" "),e.company.contacts?n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Сотрудники")]),e._v(" "),e._l(e.company.contacts,function(e){return n("vue-input",{key:e.id,attrs:{value:e.name+" - "+e.post_name,hyper:"/contact/"+e.id,icon:"user",disabled:""}})})],2):e._e(),e._v(" "),n("vue-input",{attrs:{label:"",placeholder:"Заметка",icon:"sticky-note"},model:{value:e.company.note,callback:function(a){e.$set(e.company,"note",a)},expression:"company.note"}}),e._v(" "),n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control"},[n("vue-button",{attrs:{text:"Сохранить",color:"primary"},on:{click:e.submit}})],1),e._v(" "),n("div",{staticClass:"control"},[n("vue-button",{attrs:{text:"Закрыть"},on:{click:e.close}})],1),e._v(" "),n("div",{staticClass:"control"},[n("vue-button",{attrs:{text:"Удалить",color:"danger",onclick:"return confirm('Вы действительно хотите удалить эту запись?');"}})],1)])],1)])},staticRenderFns:[]},u=n("VU/8")(m,r,!1,null,null,null);a.default=u.exports}});
//# sourceMappingURL=24.75c731ab6e5da73d9bea.js.map