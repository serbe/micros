webpackJsonp([3],{"7fiy":function(e,a,t){"use strict";a.a={id:0,phone:"",fax:!1}},EZih:function(e,a,t){"use strict";a.a={id:0,email:""}},GiBs:function(e,a,t){"use strict";a.a={id:0,phone:"",fax:!0}},JoWg:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("mvHQ"),s=t.n(n),o=t("VBGv"),i=t("m8uU"),c=t("PkiJ"),l=t("EZih"),p=t("7fiy"),m=t("GiBs"),r=t("raJt"),u={id:0,name:"",address:"",scope:r.a,scope_id:0,note:"",emails:[l.a],phones:[p.a],faxes:[m.a],practices:[{id:0,date_str:"",kind_name:"",topic:""}],contacts:[{id:0,name:"",department_name:"",post_name:"",post_go_name:""}]},d=t("7lJq"),h=t("FxBo"),f=t("OOvn"),y={name:"CompanyItem",components:{"bulma-input":o.a,"bulma-button":i.a,"bulma-select":c.a},mixins:[d.a,h.a],data:function(){return{title:"",company:u,scopes:[r.a]}},mounted:function(){this.fetchData()},methods:{onBlur:function(e,a){if(this.checkArray(this.company[e],a)){var t={};t.id=this.company[e].length+1,t[a]="",this.company[e].push(t)}},onSelect:function(e){this.scope=e,this.company.scope_id=e.id},submit:function(){var e=this,a="companies",t="POST";"0"!==this.$route.params.id&&(a=a+"/"+this.$route.params.id,t="PUT");var n=this.company;n.emails=this.filterArray(n.emails,"email"),n.phones=this.filterArray(n.phones,"phone"),n.faxes=this.filterArray(n.faxes,"phone"),Object(f.a)({url:a,method:t,mode:"cors",data:s()(n)}).then(function(){e.close()})},close:function(){this.$router.push("/companies")},delete:function(){},fetchData:function(){this.fetchItem("companies",["company","scopes"],!0)},afterFetch:function(){this.company.emails?this.company.emails.push({id:this.company.emails.length+1,email:""}):this.company.emails=[{id:1,email:""}],this.company.phones?this.company.phones.push({id:this.company.phones.length+1,phone:""}):this.company.phones=[{id:1,phone:""}],this.company.faxes?this.company.faxes.push({id:this.company.faxes.length+1,phone:""}):this.company.faxes=[{id:1,phone:""}]},customLabel:function(e){return e.name}}},v={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"container mw768"},[t("form",{attrs:{model:e.company,id:"company"}},[t("bulma-input",{attrs:{label:"",placeholder:"Наименование организации",iconLeft:"building"},model:{value:e.company.name,callback:function(a){e.$set(e.company,"name",a)},expression:"company.name"}}),e._v(" "),t("bulma-select",{attrs:{list:e.scopes,"selected-item":e.company.scope,"item-name":"scope",label:"Сфера деятельности",iconLeft:"tag"},on:{select:e.onSelect}}),e._v(" "),t("bulma-input",{attrs:{label:"",placeholder:"Адрес",iconLeft:"address-card"},model:{value:e.company.address,callback:function(a){e.$set(e.company,"address",a)},expression:"company.address"}}),e._v(" "),t("div",{staticClass:"columns"},[t("div",{staticClass:"column"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Электронный адрес")]),e._v(" "),e._l(e.company.emails,function(a,n){return t("bulma-input",{key:n,attrs:{type:"email",placeholder:"Электронный адрес",iconLeft:"envelope",autocomplete:"email",pattern:'^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$',error:"Неправильный email"},on:{blur:function(a){e.onBlur("emails","email")}},model:{value:e.company.emails[n].email,callback:function(a){e.$set(e.company.emails[n],"email",a)},expression:"company.emails[index].email"}})})],2)]),e._v(" "),t("div",{staticClass:"column"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Телефон")]),e._v(" "),e._l(e.company.phones,function(a,n){return t("bulma-input",{key:n,attrs:{type:"tel",placeholder:"Телефон",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(a){e.onBlur("phones","phone")}},model:{value:e.company.phones[n].phone,callback:function(a){e.$set(e.company.phones[n],"phone",a)},expression:"company.phones[index].phone"}})})],2)]),e._v(" "),t("div",{staticClass:"column"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Факс")]),e._v(" "),e._l(e.company.faxes,function(a,n){return t("bulma-input",{key:n,attrs:{type:"tel",placeholder:"Факс",iconLeft:"phone",autocomplete:"tel"},on:{blur:function(a){e.onBlur("faxes","phone")}},model:{value:e.company.faxes[n].phone,callback:function(a){e.$set(e.company.faxes[n],"phone",a)},expression:"company.faxes[index].phone"}})})],2)])]),e._v(" "),e.company.practices?t("div",{key:"practices",staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Тренировки")]),e._v(" "),e._l(e.company.practices,function(e){return t("bulma-input",{key:e.id,attrs:{value:e.date_str+" - "+e.kind_name+" - "+e.topic,hyper:"/practice/"+e.id,iconLeft:"history",readonly:""}})})],2):e._e(),e._v(" "),e.company.contacts?t("div",{key:"contacts",staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Сотрудники")]),e._v(" "),e._l(e.company.contacts,function(e){return t("bulma-input",{key:e.id,attrs:{value:e.name+" - "+e.post_name,hyper:"/contact/"+e.id,iconLeft:"user",readonly:""}})})],2):e._e(),e._v(" "),t("bulma-input",{attrs:{label:"",placeholder:"Заметка",iconLeft:"sticky-note"},model:{value:e.company.note,callback:function(a){e.$set(e.company,"note",a)},expression:"company.note"}}),e._v(" "),t("div",{staticClass:"field is-grouped is-grouped-centered"},[t("div",{staticClass:"control"},[t("bulma-button",{attrs:{text:"Сохранить",color:"primary"},on:{click:e.submit}})],1),e._v(" "),t("div",{staticClass:"control"},[t("bulma-button",{attrs:{text:"Закрыть"},on:{click:e.close}})],1),e._v(" "),t("div",{staticClass:"control"},[t("bulma-button",{attrs:{text:"Удалить",color:"danger",onclick:"return confirm('Вы действительно хотите удалить эту запись?');"}})],1)])],1)])},staticRenderFns:[]},b=t("VU/8")(y,v,!1,null,null,null);a.default=b.exports}});
//# sourceMappingURL=3.a743891829e8723a1a6a.js.map